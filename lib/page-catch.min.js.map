{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///page-catch.min.js","webpack:///webpack/bootstrap 2e8006acdb49072e5f73","webpack:///./src/page-catch.coffee","webpack:///./src/modules/xhr-to-base64.coffee","webpack:///./src/modules/get-relative-link.coffee","webpack:///./src/modules/xhr.coffee","webpack:///./src/modules/inline-css.coffee"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","META_ATTRIBS_FOR_DEL","TreeElementNotFound","addMeta","convertURL","defaultCleanUp","deleteMeta","deleteSendBoxAttrib","getAttribute","getDoctype","getDocument","getFramePosition","getPage","getSource","getXHR","inlineCSS","xhrToBase64","extend","child","parent","ctor","constructor","key","hasProp","prototype","__super__","hasOwnProperty","indexOf","item","i","l","length","superClass","apply","arguments","Error","getElementPath","getFramePath","_get_frame_id","fid","win","frame","frame_idx","idx","j","len","ref","frames","unshift","window","join","DOM","dictionary","getFrameId","iframe","result","obj","_getPositionOfFrame","index","nodeList","parentElement","Array","slice","children","JSON","stringify","getElementsByTagName","contentWindow","doctype","name","publicId","systemId","array","elem","mas","push","nodeName","nodeValue","document","URL","documentElement","innerHTML","attributes","htmlText","_html","attribute","attributesBody","body","html","createElement","substring","setAttribute","value","metaElements","querySelectorAll","forEach","element","ref1","removeChild","iframes","removeAttribute","url","head","meta","insertBefore","status","src","trim","tabID","cleanUp","done","createNewObj","finalize","flag","parse","callback","attributeCounter","dom","href","k","len1","len2","metas","tag","tagCounter","tags","tagsStyles","error","console","hasAttribute","stack","style","str","_document","_url","results","selector","source","framesIdx","header","counter","counter1","chrome","tabs","executeScript","code","toString","allFrames","matchAboutBlank","arrays","reader","xhr","XMLHttpRequest","open","responseType","FileReader","onload","e","blob","response","onloadend","readAsDataURL","onerror","target","send","getEnd","takeMain","takeUrl","main","protocol","hostname","substr","URI","replace","match","responseText","convertToBase64","convMas","elemMas","urlMas","conv","n"],"mappings":"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","file":"page-catch.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"page-catch\"] = factory();\n\telse\n\t\troot[\"page-catch\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"page-catch\"] = factory();\n\telse\n\t\troot[\"page-catch\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar META_ATTRIBS_FOR_DEL, TreeElementNotFound, addMeta, convertURL, defaultCleanUp, deleteMeta, deleteSendBoxAttrib, getAttribute, getDoctype, getDocument, getFramePosition, getPage, getSource, getXHR, inlineCSS, xhrToBase64,\n\t  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n\t  hasProp = {}.hasOwnProperty,\n\t  indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\t\n\txhrToBase64 = __webpack_require__(1);\n\t\n\tconvertURL = __webpack_require__(2);\n\t\n\tgetXHR = __webpack_require__(3);\n\t\n\tinlineCSS = __webpack_require__(4);\n\t\n\tMETA_ATTRIBS_FOR_DEL = ['Content-Security-Policy', 'refresh'];\n\t\n\tTreeElementNotFound = (function(superClass) {\n\t  extend(TreeElementNotFound, superClass);\n\t\n\t  function TreeElementNotFound() {\n\t    return TreeElementNotFound.__super__.constructor.apply(this, arguments);\n\t  }\n\t\n\t  return TreeElementNotFound;\n\t\n\t})(Error);\n\t\n\tgetSource = function() {\n\t\n\t  /*!\n\t   * get frame index in page\n\t   * @return {String} - frame index\n\t   * @example 0:3:5\n\t   */\n\t  var getAttribute, getDoctype, getElementPath, getFramePath;\n\t  getFramePath = function() {\n\t    var _get_frame_id, fid;\n\t    fid = [];\n\t\n\t    /*!\n\t     * add frame-ID into fid[] array (recursive)\n\t     * @param {Window} win - parent's Window object\n\t     */\n\t    _get_frame_id = function(win) {\n\t      var frame, frame_idx, idx, j, len, parent, ref;\n\t      parent = win.parent;\n\t      if (win === parent) {\n\t        return;\n\t      }\n\t      idx = '?';\n\t      ref = parent.frames;\n\t      for (frame_idx = j = 0, len = ref.length; j < len; frame_idx = ++j) {\n\t        frame = ref[frame_idx];\n\t        if (win === frame) {\n\t          idx = frame_idx;\n\t          break;\n\t        }\n\t      }\n\t      fid.unshift(idx);\n\t      _get_frame_id(parent);\n\t    };\n\t    _get_frame_id(window);\n\t    return fid.join(':');\n\t  };\n\t\n\t  /*!\n\t   * get frame position on content script\n\t   * @param {HTMLDocument} DOM - DOM document object\n\t   * @return {Object} - frames position on current frame\n\t   * @example [3,0,0]: 0\n\t   */\n\t  getElementPath = function(DOM) {\n\t    var dictionary, frames, getFrameId, i, iframe, j, len, result;\n\t    dictionary = {};\n\t\n\t    /*!\n\t     * get frameID\n\t     * @param {HTMLIframeElement} obj - iframe document object\n\t     * @return {String} - string with index iframe\n\t     * @example [3,0,0]\n\t     */\n\t    getFrameId = function(obj) {\n\t      var _getPositionOfFrame, result;\n\t      result = [];\n\t      _getPositionOfFrame = function(obj) {\n\t        var index, nodeList, parent;\n\t        if (obj.parentElement === DOM) {\n\t\n\t        } else {\n\t          parent = obj.parentElement;\n\t          nodeList = Array.prototype.slice.call(parent.children);\n\t          index = nodeList.indexOf(obj);\n\t          result.unshift(index);\n\t          return _getPositionOfFrame(parent);\n\t        }\n\t      };\n\t      _getPositionOfFrame(obj);\n\t      return JSON.stringify(result);\n\t    };\n\t    frames = DOM.getElementsByTagName('iframe');\n\t    for (j = 0, len = frames.length; j < len; j++) {\n\t      iframe = frames[j];\n\t      i = 0;\n\t      while (i < window.frames.length) {\n\t        if (iframe.contentWindow === window.frames[i]) {\n\t          dictionary[getFrameId(iframe, DOM)] = i;\n\t          result = [];\n\t          break;\n\t        }\n\t        i++;\n\t      }\n\t    }\n\t    return dictionary;\n\t  };\n\t\n\t  /*!\n\t   * get page doctype with all atributes'\n\t   * @param {DocumentType} doctype - document doctype object\n\t   * @return {array} - array with attributes of doctype page\n\t   * @return null - if doctype is absent\n\t   * @example [\"html\",\"w3c\",\"\"]\n\t   */\n\t  getDoctype = function(doctype) {\n\t    if (doctype != null) {\n\t      return [doctype.name, doctype.publicId, doctype.systemId];\n\t    }\n\t    return null;\n\t  };\n\t\n\t  /*!\n\t   * get attributes of tag <html ...>...</html>\n\t   * @param {array} array - array with html attributes\n\t   * @return {array} - array with attributes of tag <html>\n\t   * @example [\"lang\",\"en\",\"class\",\"is-copy-enable\"]\n\t   */\n\t  getAttribute = function(array) {\n\t    var elem, j, len, mas;\n\t    mas = [];\n\t    for (j = 0, len = array.length; j < len; j++) {\n\t      elem = array[j];\n\t      mas.push(elem.nodeName, elem.nodeValue);\n\t    }\n\t    return mas;\n\t  };\n\t  return [document.URL, document.documentElement.innerHTML, getAttribute(document.documentElement.attributes), getFramePath(), getElementPath(document.documentElement), getDoctype(document.doctype)];\n\t};\n\t\n\t\n\t/*!\n\t * convert html text of every frame to DOM-Tree\n\t * @param {string} htmlText - string with html code\n\t * @return {HTMLDocument} - created DOM with string\n\t */\n\t\n\tgetDocument = function(htmlText) {\n\t  var _html, attribute, attributesBody, body, html, j, len;\n\t  _html = document.createElement('html');\n\t  html = document.createElement('html');\n\t  html.innerHTML = htmlText.substring(htmlText.indexOf(\"<body\"), htmlText.length);\n\t  attributesBody = html.getElementsByTagName('body')[0].attributes;\n\t  _html.innerHTML = \"<head></head><body></body>\";\n\t  _html.getElementsByTagName('head')[0].innerHTML = htmlText.substring(htmlText.indexOf(\"<head\"), htmlText.indexOf(\"/head>\") + 6);\n\t  _html.getElementsByTagName('body')[0].innerHTML = htmlText.substring(htmlText.indexOf(\"<body\"), htmlText.length);\n\t  body = _html.getElementsByTagName('body')[0];\n\t  for (j = 0, len = attributesBody.length; j < len; j++) {\n\t    attribute = attributesBody[j];\n\t    body.setAttribute(attribute.name, attribute.value);\n\t  }\n\t  return _html;\n\t};\n\t\n\t\n\t/*!\n\t * get frame position on background script\n\t * @param {HTMLIframeElement} - iframe that we want find position,\n\t * @param {HTMLDocument} - DOM that are parent of this iframe,\n\t * @return {String} - string with iframe position\n\t * @example [3,0,0]\n\t */\n\t\n\tgetFramePosition = function(obj, DOM) {\n\t  var _getPositionOfFrame, result;\n\t  result = [];\n\t  _getPositionOfFrame = function(obj) {\n\t    var index, nodeList, parent;\n\t    if (obj.parentElement === DOM) {\n\t\n\t    } else {\n\t      parent = obj.parentElement;\n\t      nodeList = Array.prototype.slice.call(parent.children);\n\t      index = nodeList.indexOf(obj);\n\t      result.unshift(index);\n\t      return _getPositionOfFrame(parent);\n\t    }\n\t  };\n\t  _getPositionOfFrame(obj);\n\t  return JSON.stringify(result);\n\t};\n\t\n\t\n\t/*!\n\t * delete iframe security policy\n\t * @param {HTMLDocument} - DOM object\n\t */\n\t\n\tdeleteMeta = function(document) {\n\t  var metaElements;\n\t  metaElements = document.querySelectorAll('meta[http-equiv]');\n\t  return metaElements.forEach(function(element) {\n\t    var ref, ref1;\n\t    if (ref = element.getAttribute('http-equiv'), indexOf.call(META_ATTRIBS_FOR_DEL, ref) >= 0) {\n\t      return (ref1 = element.parentElement) != null ? ref1.removeChild(element) : void 0;\n\t    }\n\t  });\n\t};\n\t\n\t\n\t/*!\n\t * delete iframe security policy\n\t * @param {HTMLDocument} - DOM object\n\t */\n\t\n\tdeleteSendBoxAttrib = function(document) {\n\t  var iframes;\n\t  iframes = document.querySelectorAll('iframe[sendbox]');\n\t  return iframes.forEach(function(iframe) {\n\t    return iframe.removeAttribute('sendbox');\n\t  });\n\t};\n\t\n\t\n\t/*!\n\t * add tag meta, that this page is saved by PageCatch\n\t * @param {HTMLDocument} - DOM of current document,\n\t * @param {String} - string with url of current iframe,\n\t */\n\t\n\taddMeta = function(DOM, url) {\n\t  var head, meta, ref;\n\t  meta = document.createElement('meta');\n\t  meta.setAttribute('name', 'original-url');\n\t  meta.setAttribute('content', url);\n\t  head = (ref = DOM.getElementsByTagName('head')[0]) != null ? ref : DOM.getElementsByTagName('body')[0];\n\t  return head.insertBefore(meta, head.children[0]);\n\t};\n\t\n\t\n\t/*!\n\t * run functions for delete security policy\n\t * @param {HTMLDocument} - DOM of current document\n\t * @param {String} - string with url of current iframe\n\t */\n\t\n\tdefaultCleanUp = function(document, url) {\n\t  deleteMeta(document);\n\t  deleteSendBoxAttrib(document);\n\t  return addMeta(document, url);\n\t};\n\t\n\t\n\t/*!\n\t * take html attributes for save\n\t * @param {array} array - array with attributes of tag <html>...</html>,\n\t * @param {DocumentElement} status - Doctype of document,\n\t * @return {String} - string with html code with all atributes + doctype\n\t * @example \"<! DOCTYPE html> <html lang=\"en\" class=\"is-absent\"><head>...</html>\"\n\t */\n\t\n\tgetAttribute = function(array, status) {\n\t  var doctype, i, j, ref, src;\n\t  src = \"<html \";\n\t  for (i = j = 0, ref = array.length; j < ref; i = j += 2) {\n\t    if (array[i + 1] != null) {\n\t      src += array[i] + '=\"' + array[i + 1] + '\" ';\n\t    } else {\n\t      break;\n\t    }\n\t  }\n\t  if (status != null) {\n\t    doctype = getDoctype(status);\n\t    return doctype + src + \">\";\n\t  }\n\t  return src += \">\";\n\t};\n\t\n\t\n\t/*!\n\t * take doctype with attributes for save\n\t * @param {array} array - array with attributes of doctype,\n\t * @return {String} - string with doctype of page\n\t * @example \"<!DOCTYPE html>\"\n\t */\n\t\n\tgetDoctype = function(array) {\n\t  var elem, i, j, ref, src;\n\t  src = \"<!DOCTYPE \";\n\t  elem = \"\";\n\t  for (i = j = 0, ref = array.length; 0 <= ref ? j < ref : j > ref; i = 0 <= ref ? ++j : --j) {\n\t    if (!array[i].trim()) {\n\t      continue;\n\t    }\n\t    switch (i) {\n\t      case 0:\n\t        src += array[i] + \" \";\n\t        break;\n\t      case 1:\n\t        src += \"PUBLIC \" + '\"' + array[i] + '\" ';\n\t        break;\n\t      case 2:\n\t        src += '\"' + array[i] + '\"';\n\t    }\n\t  }\n\t  return src + \">\";\n\t};\n\t\n\t\n\t/*!\n\t * save page\n\t * @param {Number} tabID - number of tab which you want to save,\n\t * @param {Function} cleanUp - function with clean any attributes from page,\n\t * @param {Function} done - function in which will be return html text of\n\t *                          saved page\n\t * @example \"<! DOCTYPE html> <html lang=\"en\" class=\"is-absent\"><head>...</html>\"\n\t */\n\t\n\tgetPage = function(tabID, cleanUp, done) {\n\t  var createNewObj, dictionary, finalize, flag, parse;\n\t  dictionary = {};\n\t  flag = false;\n\t\n\t  /*!\n\t   * parse tags as img,style,link and parse attribute style in any tags with him\n\t   * @param {Function} callback - function that check completing of save\n\t   */\n\t  parse = function(callback) {\n\t    var attributeCounter, dom, href, j, k, key, l, len, len1, len2, meta, metas, ref, src, tag, tagCounter, tags, tagsStyles;\n\t    metas = (ref = dictionary[\"\"]) != null ? ref.document.querySelectorAll('[name]') : void 0;\n\t    for (j = 0, len = metas.length; j < len; j++) {\n\t      meta = metas[j];\n\t      if (meta.getAttribute('name') === 'original-url') {\n\t        flag = true;\n\t        callback(0, 0);\n\t        return;\n\t      }\n\t    }\n\t    attributeCounter = 0;\n\t    tagCounter = 0;\n\t    for (key in dictionary) {\n\t      dom = dictionary[key];\n\t      tagsStyles = dom.document.querySelectorAll('*[style]');\n\t      for (k = 0, len1 = tagsStyles.length; k < len1; k++) {\n\t        tag = tagsStyles[k];\n\t        attributeCounter++;\n\t        inlineCSS(tag.getAttribute('style'), tag, dom.url, function(error, tag, result) {\n\t          attributeCounter--;\n\t          if (error != null) {\n\t            console.error(\"Style attr error\", error);\n\t          } else {\n\t            tag.setAttribute('style', result);\n\t          }\n\t          return callback(tagCounter, attributeCounter);\n\t        });\n\t      }\n\t      tags = dom.document.querySelectorAll('img,link,style');\n\t      for (l = 0, len2 = tags.length; l < len2; l++) {\n\t        tag = tags[l];\n\t        tagCounter++;\n\t        if (tag.hasAttribute('src')) {\n\t          src = convertURL(tag.getAttribute('src'), dom.url);\n\t          xhrToBase64(src, tag, function(error, tag, result) {\n\t            tagCounter--;\n\t            if (error != null) {\n\t              console.error(\"(src)Base 64 error:\", error.stack);\n\t            } else {\n\t              tag.setAttribute(\"src\", result);\n\t            }\n\t            return callback(tagCounter, attributeCounter);\n\t          });\n\t        } else if (tag.hasAttribute('href')) {\n\t          if (tag.getAttribute('rel') === \"stylesheet\") {\n\t            href = convertURL(tag.getAttribute('href'), dom.url);\n\t            inlineCSS(getXHR(href), tag, href, function(error, tag, result) {\n\t              var parent, style;\n\t              if (error != null) {\n\t                console.error(\"style error\", error);\n\t              } else {\n\t                tagCounter--;\n\t                style = document.createElement('style');\n\t                style.innerHTML = result;\n\t                parent = tag.parentElement;\n\t                tag.parentElement.insertBefore(style, tag);\n\t                tag.parentElement.removeChild(tag);\n\t              }\n\t              return callback(tagCounter, attributeCounter);\n\t            });\n\t          } else {\n\t            href = convertURL(tag.getAttribute('href'), dom.url);\n\t            xhrToBase64(href, tag, function(error, tag, result) {\n\t              tagCounter--;\n\t              if (error != null) {\n\t                console.error(\"(href) xhrToBase64 error (href=\" + href + \"):\", error.stack);\n\t              } else {\n\t                tag.setAttribute(\"href\", result);\n\t              }\n\t              return callback(tagCounter, attributeCounter);\n\t            });\n\t          }\n\t        } else {\n\t          inlineCSS(tag.innerHTML, tag, dom.url, function(error, tag, result) {\n\t            tagCounter--;\n\t            if (error != null) {\n\t              console.error(\"(style)inlineCSS error:\", error.stack);\n\t              console.error(tag.innerHTML);\n\t            } else {\n\t              tag.innerHTML = result;\n\t            }\n\t            return callback(tagCounter, attributeCounter);\n\t          });\n\t        }\n\t      }\n\t    }\n\t    return flag = true;\n\t  };\n\t\n\t  /*!\n\t   * create one object from dictionary of frames\n\t   * @param {Object} obj - obj of dictionary(any frame from page)\n\t   * @param {String} str - string with current index in recursive\n\t   */\n\t  createNewObj = function(obj, str) {\n\t    var _document, _url, frame, frames, index, j, key, len, results, selector, source;\n\t    frames = obj.document.getElementsByTagName('iframe');\n\t    results = [];\n\t    for (j = 0, len = frames.length; j < len; j++) {\n\t      frame = frames[j];\n\t      selector = getFramePosition(frame, obj.document);\n\t      index = -1;\n\t      for (key in obj.framesIdx) {\n\t        if (selector === key) {\n\t          index = obj.framesIdx[key];\n\t        }\n\t      }\n\t      if (index === -1) {\n\t        continue;\n\t      }\n\t      key = str + index;\n\t      if (dictionary[key] != null) {\n\t        createNewObj(dictionary[key], key + \":\");\n\t        _url = dictionary[key].url;\n\t        _document = dictionary[key].document;\n\t        defaultCleanUp(_document, _url);\n\t        if (typeof cleanUp === \"function\") {\n\t          cleanUp(_document, _url);\n\t        }\n\t        source = getAttribute(dictionary[key].header, dictionary[key].doctype) + _document.innerHTML + \"</html>\";\n\t        results.push(frame.setAttribute('srcdoc', source));\n\t      } else {\n\t        results.push(void 0);\n\t      }\n\t    }\n\t    return results;\n\t  };\n\t\n\t  /*!\n\t   * finish and return string with complete all resourses in one HTML\n\t   * @param {Number} counter - counter of tags\n\t   * @param {Number} counter1 - counter of attributes\n\t   */\n\t  finalize = function(counter, counter1) {\n\t    var _document, _url, result;\n\t    if (counter === 0 && counter1 === 0 && flag === true) {\n\t      createNewObj(dictionary[\"\"], \"\");\n\t      _url = dictionary[\"\"].url;\n\t      _document = dictionary[\"\"].document;\n\t      defaultCleanUp(_document, _url);\n\t      if (typeof cleanUp === \"function\") {\n\t        cleanUp(_document, _url);\n\t      }\n\t      result = getAttribute(dictionary[\"\"].header, dictionary[\"\"].doctype) + _document.innerHTML + \"</html>\";\n\t      if (typeof done === \"function\") {\n\t        done(result);\n\t      }\n\t      dictionary = {};\n\t      return flag = false;\n\t    }\n\t  };\n\t  return chrome.tabs.executeScript(tabID, {\n\t    code: \"(\" + getSource.toString() + \")()\",\n\t    allFrames: true,\n\t    matchAboutBlank: true\n\t  }, function(arrays) {\n\t    var dom, j, len, obj;\n\t    for (j = 0, len = arrays.length; j < len; j++) {\n\t      dom = arrays[j];\n\t      obj = {\n\t        url: dom[0],\n\t        header: dom[2],\n\t        document: getDocument(dom[1]),\n\t        framesIdx: dom[4],\n\t        doctype: dom[5]\n\t      };\n\t      dictionary[dom[3]] = obj;\n\t    }\n\t    return parse(finalize);\n\t  });\n\t};\n\t\n\tmodule.exports = getPage;\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\tvar xhrToBase64;\n\t\n\txhrToBase64 = function(url, elem, callback) {\n\t  var reader, xhr;\n\t  if (url.indexOf(\"data:\") >= 0) {\n\t    return callback(null, elem, url);\n\t  } else {\n\t    xhr = new XMLHttpRequest();\n\t    xhr.open('GET', url, true);\n\t    xhr.responseType = 'blob';\n\t    reader = new FileReader();\n\t    xhr.onload = function(e) {\n\t      var blob;\n\t      if (this.status !== 200) {\n\t        return callback(null, elem, \" \", url);\n\t      } else {\n\t        blob = this.response;\n\t        reader.onloadend = function() {\n\t          return callback(null, elem, reader.result, url);\n\t        };\n\t        return reader.readAsDataURL(blob);\n\t      }\n\t    };\n\t    xhr.onerror = function(e) {\n\t      console.error(\"XHR Error \" + e.target.status + \" occurred while receiving the document.\");\n\t      return callback(e, elem, url, url);\n\t    };\n\t    return xhr.send();\n\t  }\n\t};\n\t\n\tmodule.exports = xhrToBase64;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\tvar getEnd, takeMain, takeUrl;\n\t\n\ttakeMain = function(main, counter, flag) {\n\t  var i, url;\n\t  if (flag === true) {\n\t    url = document.createElement('a');\n\t    url.href = main;\n\t    return url.protocol + \"//\" + url.hostname;\n\t  }\n\t  i = main.length;\n\t  while (main[i] !== \"/\") {\n\t    i--;\n\t  }\n\t  main = main.substr(0, i);\n\t  i = main.length;\n\t  while (counter !== 0) {\n\t    if (main[i] === \"/\") {\n\t      counter--;\n\t    }\n\t    i--;\n\t  }\n\t  main = main.substr(0, i + 1);\n\t  return main;\n\t};\n\t\n\ttakeUrl = function(url) {\n\t  var counter, i;\n\t  i = 0;\n\t  counter = 0;\n\t  while (url.indexOf(\"..\", i) !== -1 && url.indexOf(\"./\", i) !== -1) {\n\t    if (url.indexOf(\"..\", i) === -1) {\n\t      i = url.indexOf(\"./\", i) + 2;\n\t    } else {\n\t      counter++;\n\t      i = url.indexOf(\"..\", i) + 3;\n\t    }\n\t  }\n\t  if (counter === 0 && url[0] === \"/\") {\n\t    url = url.substr(1);\n\t    return [url, counter, true];\n\t  }\n\t  if (i !== 0) {\n\t    url = url.substr(i);\n\t  }\n\t  return [url, counter, false];\n\t};\n\t\n\tgetEnd = function(main) {\n\t  var i, result;\n\t  i = main.length - 1;\n\t  result = \"\";\n\t  while (main[i] !== \"/\") {\n\t    result = main[i] + result;\n\t    i--;\n\t  }\n\t  return result;\n\t};\n\t\n\tmodule.exports = function(url, main) {\n\t  var URI;\n\t  url = url.replace(/\\s/g, '');\n\t  if ((url[0] === '\"' && url[url.length - 1] === '\"') || (url[0] === \"'\" && url[url.length - 1] === \"'\")) {\n\t    url = url.substr(1, url.length - 2);\n\t  }\n\t  if (url[0] === \"/\" && url[1] === \"/\") {\n\t    return \"https:\" + url;\n\t  }\n\t  if (url.match(/^[\\w\\-_\\d]+:/)) {\n\t    return url;\n\t  }\n\t  URI = takeUrl(url);\n\t  url = URI[0];\n\t  if (URI[2] === true) {\n\t    return takeMain(main, URI[1], URI[2]) + \"/\" + url;\n\t  } else {\n\t    return takeMain(main, URI[1], URI[2]) + \"/\" + url;\n\t  }\n\t};\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function(url) {\n\t  var e, xhr;\n\t  try {\n\t    xhr = new XMLHttpRequest();\n\t    xhr.open('GET', url, false);\n\t    xhr.send();\n\t    if (xhr.status === 200) {\n\t      return xhr.responseText;\n\t    } else {\n\t      return \" \";\n\t    }\n\t  } catch (error) {\n\t    e = error;\n\t    console.error(\"XHR\", e.stack);\n\t    return \" \";\n\t  }\n\t};\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar convertToBase64, convertURL;\n\t\n\tconvertURL = __webpack_require__(2);\n\t\n\tconvertToBase64 = __webpack_require__(1);\n\t\n\tmodule.exports = function(src, dom, source, callback) {\n\t  var convMas, counter, elemMas, i, j, k, l, ref, results, urlMas;\n\t  if (src.indexOf(\"url(\") < 0) {\n\t    return callback(null, dom, src);\n\t  } else {\n\t    urlMas = [];\n\t    elemMas = [];\n\t    convMas = [];\n\t    i = 0;\n\t    while (i < src.length) {\n\t      k = src.indexOf(\"url(\", i);\n\t      if (k !== -1) {\n\t        elemMas.push(src.substring(i, k + 4));\n\t        j = src.indexOf(\")\", k + 1);\n\t        urlMas.push(convertURL(src.substring(k + 4, j), source));\n\t        i = j;\n\t      } else {\n\t        elemMas.push(src.substring(i, src.length));\n\t        break;\n\t      }\n\t    }\n\t    counter = urlMas.length;\n\t    results = [];\n\t    for (i = l = 0, ref = urlMas.length; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n\t      results.push(convertToBase64(urlMas[i], dom, function(error, obj, result, url) {\n\t        var conv, elem, index, len, len1, m, n;\n\t        counter--;\n\t        if (error != null) {\n\t          console.error(\"Error base64:\", error.stack);\n\t        } else {\n\t          convMas.push([url, result]);\n\t        }\n\t        if (counter === 0) {\n\t          src = \"\";\n\t          i = 0;\n\t          for (m = 0, len = elemMas.length; m < len; m++) {\n\t            elem = elemMas[m];\n\t            src += elem;\n\t            if (urlMas[i] != null) {\n\t              j = -1;\n\t              for (index = n = 0, len1 = convMas.length; n < len1; index = ++n) {\n\t                conv = convMas[index];\n\t                if (conv[0] === urlMas[i]) {\n\t                  j = index;\n\t                  break;\n\t                }\n\t              }\n\t              if (j >= 0) {\n\t                src += convMas[j][1];\n\t              }\n\t              i++;\n\t            }\n\t          }\n\t          return callback(null, dom, src);\n\t        }\n\t      }));\n\t    }\n\t    return results;\n\t  }\n\t};\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// page-catch.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2e8006acdb49072e5f73","xhrToBase64 = require './modules/xhr-to-base64.coffee'\r\nconvertURL = require './modules/get-relative-link.coffee'\r\ngetXHR = require './modules/xhr.coffee'\r\ninlineCSS = require './modules/inline-css.coffee'\r\n\r\n\r\n\r\nMETA_ATTRIBS_FOR_DEL = [\r\n  'Content-Security-Policy'\r\n  'refresh'\r\n]\r\n\r\nclass TreeElementNotFound extends Error\r\n\r\n\r\n# get array with information of every frame\r\ngetSource = () ->\r\n\r\n  ###!\r\n  # get frame index in page\r\n  # @return {String} - frame index\r\n  # @example 0:3:5\r\n  ###\r\n  getFramePath = () ->\r\n    fid = []\r\n\r\n    ###!\r\n    # add frame-ID into fid[] array (recursive)\r\n    # @param {Window} win - parent's Window object\r\n    ###\r\n    _get_frame_id = (win) ->\r\n      parent = win.parent\r\n      return if win == parent\r\n      idx = '?'\r\n      for frame, frame_idx in parent.frames\r\n        if win == frame\r\n          idx = frame_idx\r\n          break\r\n      fid.unshift idx\r\n      _get_frame_id(parent)\r\n      return\r\n    _get_frame_id(window)\r\n    return fid.join ':'\r\n\r\n  ###!\r\n  # get frame position on content script\r\n  # @param {HTMLDocument} DOM - DOM document object\r\n  # @return {Object} - frames position on current frame\r\n  # @example [3,0,0]: 0\r\n  ###\r\n  getElementPath = (DOM) ->\r\n    dictionary = {}\r\n\r\n    ###!\r\n    # get frameID\r\n    # @param {HTMLIframeElement} obj - iframe document object\r\n    # @return {String} - string with index iframe\r\n    # @example [3,0,0]\r\n    ###\r\n    getFrameId = (obj) ->\r\n      result = []\r\n      _getPositionOfFrame = (obj)->\r\n        if obj.parentElement == DOM\r\n          return\r\n        else\r\n          parent = obj.parentElement\r\n          nodeList = Array.prototype.slice.call(parent.children)\r\n          index = nodeList.indexOf(obj)\r\n          result.unshift(index)\r\n          _getPositionOfFrame(parent)\r\n      _getPositionOfFrame(obj)\r\n      #console.log result\r\n      return JSON.stringify(result)\r\n\r\n    frames = DOM.getElementsByTagName 'iframe'\r\n    #console.log frames.length\r\n    for iframe in frames\r\n      i = 0\r\n      while i<window.frames.length\r\n        if iframe.contentWindow == window.frames[i]\r\n          #console.log getFrameId(iframe, DOM)\r\n          dictionary[getFrameId(iframe, DOM)] = i\r\n          result = []\r\n          break\r\n        i++\r\n    return dictionary\r\n\r\n  ###!\r\n  # get page doctype with all atributes'\r\n  # @param {DocumentType} doctype - document doctype object\r\n  # @return {array} - array with attributes of doctype page\r\n  # @return null - if doctype is absent\r\n  # @example [\"html\",\"w3c\",\"\"]\r\n  ###\r\n  getDoctype = (doctype)->\r\n    if doctype?\r\n      return [doctype.name, doctype.publicId, doctype.systemId]\r\n    return null\r\n\r\n  ###!\r\n  # get attributes of tag <html ...>...</html>\r\n  # @param {array} array - array with html attributes\r\n  # @return {array} - array with attributes of tag <html>\r\n  # @example [\"lang\",\"en\",\"class\",\"is-copy-enable\"]\r\n  ###\r\n  getAttribute = (array)->\r\n    mas = []\r\n    for elem in array\r\n      mas.push(elem.nodeName, elem.nodeValue)\r\n    return mas\r\n\r\n  # Function returns iframe url, content, html-atributes,\r\n  # iframe-selectors and iframe-path\r\n  return [\r\n    document.URL,\r\n    document.documentElement.innerHTML,\r\n    getAttribute(document.documentElement.attributes),\r\n    getFramePath(),\r\n    getElementPath(document.documentElement),\r\n    getDoctype(document.doctype)\r\n  ]\r\n\r\n###!\r\n# convert html text of every frame to DOM-Tree\r\n# @param {string} htmlText - string with html code\r\n# @return {HTMLDocument} - created DOM with string\r\n###\r\ngetDocument = (htmlText) ->\r\n  _html = document.createElement 'html'\r\n  html = document.createElement 'html'\r\n  html.innerHTML = htmlText.substring(\r\n    htmlText.indexOf(\"<body\"),\r\n    htmlText.length\r\n  )\r\n  attributesBody = html.getElementsByTagName('body')[0].attributes\r\n  _html.innerHTML = \"<head></head><body></body>\"\r\n  _html.getElementsByTagName('head')[0].innerHTML = htmlText.substring(\r\n    htmlText.indexOf(\"<head\"), htmlText.indexOf(\"/head>\") + 6\r\n  )\r\n  _html.getElementsByTagName('body')[0].innerHTML = htmlText.substring(\r\n    htmlText.indexOf(\"<body\"), htmlText.length\r\n  )\r\n  body = _html.getElementsByTagName('body')[0]\r\n  for attribute in attributesBody\r\n    body.setAttribute attribute.name, attribute.value\r\n  return _html\r\n\r\n###!\r\n# get frame position on background script\r\n# @param {HTMLIframeElement} - iframe that we want find position,\r\n# @param {HTMLDocument} - DOM that are parent of this iframe,\r\n# @return {String} - string with iframe position\r\n# @example [3,0,0]\r\n###\r\ngetFramePosition = (obj, DOM) ->\r\n  result = []\r\n  _getPositionOfFrame = (obj)->\r\n    if obj.parentElement == DOM\r\n      return\r\n    else\r\n      parent = obj.parentElement\r\n      nodeList = Array.prototype.slice.call(parent.children)\r\n      index = nodeList.indexOf(obj)\r\n      result.unshift(index)\r\n      _getPositionOfFrame(parent)\r\n  _getPositionOfFrame(obj)\r\n  return JSON.stringify(result)\r\n\r\n###!\r\n# delete iframe security policy\r\n# @param {HTMLDocument} - DOM object\r\n###\r\ndeleteMeta = (document) ->\r\n  metaElements = document.querySelectorAll('meta[http-equiv]')\r\n  metaElements.forEach (element) ->\r\n    if element.getAttribute('http-equiv') in META_ATTRIBS_FOR_DEL\r\n      element.parentElement?.removeChild(element)\r\n\r\n###!\r\n# delete iframe security policy\r\n# @param {HTMLDocument} - DOM object\r\n###\r\ndeleteSendBoxAttrib = (document) ->\r\n  iframes = document.querySelectorAll('iframe[sendbox]')\r\n  iframes.forEach (iframe) ->\r\n    iframe.removeAttribute('sendbox')\r\n\r\n###!\r\n# add tag meta, that this page is saved by PageCatch\r\n# @param {HTMLDocument} - DOM of current document,\r\n# @param {String} - string with url of current iframe,\r\n###\r\naddMeta = (DOM, url)->\r\n  meta = document.createElement 'meta'\r\n  meta.setAttribute 'name','original-url'\r\n  meta.setAttribute 'content', url\r\n  head = (\r\n    DOM.getElementsByTagName('head')[0] ?\r\n    DOM.getElementsByTagName('body')[0]\r\n  )\r\n  head.insertBefore meta, head.children[0]\r\n\r\n###!\r\n# run functions for delete security policy\r\n# @param {HTMLDocument} - DOM of current document\r\n# @param {String} - string with url of current iframe\r\n###\r\ndefaultCleanUp = (document,url) ->\r\n  deleteMeta(document)\r\n  deleteSendBoxAttrib(document)\r\n  addMeta(document,url)\r\n\r\n###!\r\n# take html attributes for save\r\n# @param {array} array - array with attributes of tag <html>...</html>,\r\n# @param {DocumentElement} status - Doctype of document,\r\n# @return {String} - string with html code with all atributes + doctype\r\n# @example \"<! DOCTYPE html> <html lang=\"en\" class=\"is-absent\"><head>...</html>\"\r\n###\r\ngetAttribute = (array, status) ->\r\n  src = \"<html \"\r\n  for i in [0...array.length] by 2\r\n    if array[i+1]?\r\n      src += array[i] + '=\"' + array[i+1] + '\" '\r\n    else\r\n      break\r\n  #console.log status\r\n  if status?\r\n    doctype = getDoctype(status)\r\n    #console.log doctype\r\n    return doctype + src + \">\"\r\n  return src += \">\"\r\n\r\n###!\r\n# take doctype with attributes for save\r\n# @param {array} array - array with attributes of doctype,\r\n# @return {String} - string with doctype of page\r\n# @example \"<!DOCTYPE html>\"\r\n###\r\ngetDoctype = (array) ->\r\n  src = \"<!DOCTYPE \"\r\n  elem = \"\"\r\n  for i in [0...array.length]\r\n    continue if not array[i].trim()\r\n    switch i\r\n      when 0 then src += array[i] + \" \"\r\n      when 1 then src += \"PUBLIC \" + '\"' + array[i] + '\" '\r\n      when 2 then src += '\"' + array[i] + '\"'\r\n    #console.log src\r\n  return src + \">\"\r\n\r\n###!\r\n# save page\r\n# @param {Number} tabID - number of tab which you want to save,\r\n# @param {Function} cleanUp - function with clean any attributes from page,\r\n# @param {Function} done - function in which will be return html text of\r\n#                          saved page\r\n# @example \"<! DOCTYPE html> <html lang=\"en\" class=\"is-absent\"><head>...</html>\"\r\n###\r\ngetPage = (tabID, cleanUp, done) ->\r\n  dictionary = {}\r\n  flag = false\r\n  \r\n  ###!\r\n  # parse tags as img,style,link and parse attribute style in any tags with him\r\n  # @param {Function} callback - function that check completing of save\r\n  ###\r\n  parse = (callback) ->\r\n    metas = dictionary[\"\"]?.document.querySelectorAll '[name]'\r\n    for meta in metas\r\n      if meta.getAttribute('name') == 'original-url'\r\n        flag = true\r\n        callback 0, 0\r\n        return\r\n    attributeCounter = 0\r\n    tagCounter = 0\r\n    for key, dom of dictionary\r\n      tagsStyles = dom.document.querySelectorAll '*[style]'\r\n      for tag in tagsStyles\r\n        attributeCounter++\r\n        inlineCSS tag.getAttribute('style'), tag, dom.url,\r\n          (error, tag, result) ->\r\n            attributeCounter--\r\n            if error?\r\n              console.error \"Style attr error\", error\r\n            else\r\n              tag.setAttribute('style', result)\r\n            callback tagCounter, attributeCounter\r\n      tags = dom.document.querySelectorAll 'img,link,style'\r\n      for tag in tags\r\n        tagCounter++\r\n        if(tag.hasAttribute('src'))\r\n          src = convertURL tag.getAttribute('src'), dom.url\r\n          xhrToBase64 src, tag, (error, tag, result) ->\r\n            tagCounter--\r\n            if error?\r\n              console.error \"(src)Base 64 error:\", error.stack\r\n            else\r\n              tag.setAttribute \"src\", result\r\n            callback tagCounter, attributeCounter\r\n        else if(tag.hasAttribute('href'))\r\n          if(tag.getAttribute('rel') == \"stylesheet\")\r\n            href = convertURL(tag.getAttribute('href'), dom.url)\r\n            inlineCSS getXHR(href), tag, href, (error, tag, result) ->\r\n              if error?\r\n                console.error \"style error\", error\r\n              else\r\n                tagCounter--\r\n                style = document.createElement 'style'\r\n                style.innerHTML = result\r\n                parent = tag.parentElement\r\n                tag.parentElement.insertBefore style, tag\r\n                tag.parentElement.removeChild tag\r\n              callback tagCounter, attributeCounter\r\n          else\r\n            href = convertURL(tag.getAttribute('href'), dom.url)\r\n            xhrToBase64 href, tag, (error, tag, result) ->\r\n              tagCounter--\r\n              if error?\r\n                console.error \"(href) xhrToBase64 error (href=#{href}):\", \\\r\n                  error.stack\r\n              else\r\n                tag.setAttribute \"href\", result\r\n              callback tagCounter, attributeCounter\r\n        else\r\n          inlineCSS tag.innerHTML, tag, dom.url, (error, tag, result) ->\r\n            tagCounter--\r\n            if error?\r\n              console.error \"(style)inlineCSS error:\", error.stack\r\n              console.error tag.innerHTML\r\n            else\r\n              tag.innerHTML = result\r\n            callback tagCounter, attributeCounter\r\n    flag = true\r\n  ###!\r\n  # create one object from dictionary of frames\r\n  # @param {Object} obj - obj of dictionary(any frame from page)\r\n  # @param {String} str - string with current index in recursive\r\n  ###\r\n  createNewObj = (obj, str) ->\r\n    frames = obj.document.getElementsByTagName 'iframe'\r\n    for frame in frames\r\n      selector = getFramePosition(frame, obj.document)\r\n      #console.log selector\r\n      index = -1\r\n      for key of obj.framesIdx\r\n        #console.log key\r\n        if selector == key\r\n          index= obj.framesIdx[key]\r\n      if index == -1\r\n        continue\r\n      key = str + index\r\n      if dictionary[key]?\r\n        createNewObj dictionary[key], key+\":\"\r\n        _url = dictionary[key].url\r\n        _document = dictionary[key].document\r\n        defaultCleanUp _document, _url\r\n        cleanUp?(_document, _url)\r\n        source = getAttribute(\r\n          dictionary[key].header,\r\n          dictionary[key].doctype\r\n        ) + _document.innerHTML + \"</html>\"\r\n        frame.setAttribute('srcdoc', source)\r\n\r\n  ###!\r\n  # finish and return string with complete all resourses in one HTML\r\n  # @param {Number} counter - counter of tags\r\n  # @param {Number} counter1 - counter of attributes\r\n  ###\r\n  finalize = (counter, counter1) ->\r\n    if counter == 0 and counter1 == 0 and flag == true\r\n      createNewObj dictionary[\"\"],\"\"\r\n      _url = dictionary[\"\"].url\r\n      _document = dictionary[\"\"].document\r\n      defaultCleanUp _document, _url\r\n      cleanUp?(_document, _url)\r\n      result = getAttribute(\r\n        dictionary[\"\"].header, dictionary[\"\"].doctype\r\n      ) + _document.innerHTML + \"</html>\"\r\n      done?(result)\r\n      dictionary = {}\r\n      flag = false\r\n\r\n\r\n  # START\r\n  chrome.tabs.executeScript tabID,\r\n    code: \"(\" + getSource.toString() + \")()\" # transform function to the\r\n                                             # string and wrap it into the\r\n                                             # closure to execute it\r\n                                             # immidiatelly after\r\n                                             # injecting\r\n    allFrames: true,\r\n    matchAboutBlank: true\r\n  , (arrays) ->\r\n    for dom in arrays\r\n      obj =\r\n        url: dom[0]\r\n        header: dom[2]\r\n        document: getDocument(dom[1])\r\n        framesIdx: dom[4]\r\n        doctype: dom[5]\r\n      dictionary[dom[3]] = obj\r\n    parse(finalize)\r\n\r\nmodule.exports = getPage\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/coffeelint-loader!./src/page-catch.coffee","xhrToBase64 = (url, elem, callback) ->\r\n  if(url.indexOf(\"data:\") >= 0)\r\n    callback null, elem, url\r\n  else\r\n    #console.log \"xhr-to-base64: Url='#{url}'\"\r\n    xhr = new XMLHttpRequest()\r\n    xhr.open 'GET', url, true\r\n    xhr.responseType = 'blob'\r\n    reader = new FileReader()\r\n\r\n    xhr.onload = (e) ->\r\n      #console.log \"xhr-to-base64: XHR LOAD\"\r\n      if this.status != 200\r\n        callback null, elem, \" \", url\r\n      else\r\n        blob = this.response\r\n        reader.onloadend = () ->\r\n          callback null, elem, reader.result, url\r\n        reader.readAsDataURL(blob)\r\n\r\n    xhr.onerror = (e) ->\r\n      console.error \"XHR Error \" + \\\r\n        e.target.status + \\\r\n        \" occurred while receiving the document.\"\r\n      callback e, elem, url,url\r\n\r\n    xhr.send()\r\n\r\nmodule.exports = xhrToBase64\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/coffeelint-loader!./src/modules/xhr-to-base64.coffee","\r\ntakeMain = (main, counter, flag) ->\r\n  if flag == true\r\n    url = document.createElement('a')\r\n    url.href = main\r\n    return url.protocol + \"//\" + url.hostname\r\n  i = main.length\r\n  while main[i] != \"/\" then i--\r\n  main = main.substr 0, i\r\n  i = main.length\r\n  while counter != 0\r\n    counter-- if main[i] == \"/\"\r\n    i--\r\n  main = main.substr 0, i + 1\r\n  return main\r\n\r\n\r\ntakeUrl = (url) ->\r\n  i = 0\r\n  counter = 0\r\n  while url.indexOf(\"..\", i) != -1 and url.indexOf(\"./\", i) != -1\r\n    if url.indexOf(\"..\", i) == -1\r\n      i = url.indexOf(\"./\", i) + 2\r\n    else\r\n      counter++\r\n      i = url.indexOf(\"..\", i) + 3\r\n  if counter == 0 and url[0] == \"/\"\r\n    url = url.substr 1\r\n    return [url, counter, true]\r\n  if i != 0\r\n    url = url.substr i\r\n  return [url, counter, false]\r\n\r\n\r\ngetEnd = (main) ->\r\n  i = main.length - 1\r\n  result = \"\"\r\n  while main[i] != \"/\"\r\n    result = main[i] + result\r\n    i--\r\n  return result\r\n\r\n\r\nmodule.exports = (url, main) ->\r\n  url = url.replace(/\\s/g, '')\r\n  #console.warn \"URL: \",url\r\n  #console.warn \"MAIN: \",main\r\n  if (\r\n    (url[0] == '\"' and url[url.length - 1] == '\"') or\r\n    (url[0] == \"'\" and url[url.length - 1] == \"'\")\r\n  )\r\n    url= url.substr 1, url.length - 2\r\n\r\n  if url[0] == \"/\" and url[1] == \"/\"\r\n    return \"https:\" + url\r\n\r\n  if url.match(/^[\\w\\-_\\d]+:/)\r\n    return url\r\n\r\n  URI = takeUrl(url)\r\n  url = URI[0]\r\n  if URI[2] == true\r\n    return takeMain(main, URI[1], URI[2]) + \"/\" + url\r\n  else\r\n    return takeMain(main, URI[1], URI[2]) + \"/\" + url\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/coffeelint-loader!./src/modules/get-relative-link.coffee","module.exports = (url) ->\r\n  try\r\n    #console.log \"xhr: Url ='#{url}'\"\r\n    xhr = new XMLHttpRequest()\r\n    xhr.open 'GET', url, false\r\n    xhr.send()\r\n    if xhr.status ==200\r\n      return xhr.responseText\r\n    else\r\n      return \" \"\r\n  catch e\r\n    console.error \"XHR\", e.stack\r\n    return \" \"\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/coffeelint-loader!./src/modules/xhr.coffee","convertURL = require '../modules/get-relative-link.coffee'\r\nconvertToBase64 = require '../modules/xhr-to-base64.coffee'\r\n\r\n\r\nmodule.exports = (src, dom, source, callback) ->\r\n  if(src.indexOf(\"url(\") < 0)\r\n    callback null, dom, src\r\n  else\r\n    #console.log \"inline-css:\", src, dom\r\n    urlMas = []\r\n    elemMas = []\r\n    convMas = []\r\n    i = 0\r\n    while i < src.length\r\n      k = src.indexOf \"url(\", i\r\n      if k!= -1\r\n        elemMas.push src.substring(i, k+4)\r\n        j = src.indexOf \")\", k+1\r\n        urlMas.push convertURL(src.substring(k+4, j), source)\r\n        i = j\r\n      else\r\n        elemMas.push src.substring(i, src.length)\r\n        break\r\n    counter = urlMas.length\r\n    for i in [0...urlMas.length]\r\n      convertToBase64 urlMas[i], dom, (error, obj, result, url) ->\r\n        counter--\r\n        if error?\r\n          console.error \"Error base64:\", error.stack\r\n        else\r\n          convMas.push([url, result])\r\n\r\n        if counter == 0\r\n          src = \"\"\r\n          i = 0\r\n          for elem in elemMas\r\n            src += elem\r\n            if urlMas[i]?\r\n              j = -1\r\n              for conv, index in convMas\r\n                if conv[0] == urlMas[i]\r\n                  j = index\r\n                  break\r\n              if j >= 0\r\n                src += convMas[j][1]\r\n              i++\r\n          callback null, dom, src\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/coffeelint-loader!./src/modules/inline-css.coffee"],"sourceRoot":""}